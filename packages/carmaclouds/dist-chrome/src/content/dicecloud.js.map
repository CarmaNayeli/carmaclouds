{
  "version": 3,
  "sources": ["../../../src/content/dicecloud-extraction.js", "../../../src/content/dicecloud.js"],
  "sourcesContent": ["/**\r\n * Comprehensive DiceCloud character data extraction\r\n * Copied from proven OwlCloud implementation\r\n */\r\n\r\n// Standardized DiceCloud variable names\r\nconst STANDARD_VARS = {\r\n  abilities: ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma'],\r\n  abilityMods: ['strengthMod', 'dexterityMod', 'constitutionMod', 'intelligenceMod', 'wisdomMod', 'charismaMod'],\r\n  saves: ['strengthSave', 'dexteritySave', 'constitutionSave', 'intelligenceSave', 'wisdomSave', 'charismaSave'],\r\n  skills: [\r\n    'acrobatics', 'animalHandling', 'arcana', 'athletics', 'deception', 'history',\r\n    'insight', 'intimidation', 'investigation', 'medicine', 'nature', 'perception',\r\n    'performance', 'persuasion', 'religion', 'sleightOfHand', 'stealth', 'survival'\r\n  ],\r\n  combat: ['armorClass', 'hitPoints', 'speed', 'initiative', 'proficiencyBonus']\r\n};\r\n\r\n/**\r\n * Determines hit die type from character class (D&D 5e)\r\n */\r\nfunction getHitDieTypeFromClass(levels) {\r\n  const hitDiceMap = {\r\n    'barbarian': 'd12',\r\n    'fighter': 'd10',\r\n    'paladin': 'd10',\r\n    'ranger': 'd10',\r\n    'bard': 'd8',\r\n    'cleric': 'd8',\r\n    'druid': 'd8',\r\n    'monk': 'd8',\r\n    'rogue': 'd8',\r\n    'warlock': 'd8',\r\n    'sorcerer': 'd6',\r\n    'wizard': 'd6'\r\n  };\r\n\r\n  if (levels && levels.length > 0) {\r\n    const primaryClass = levels[0]?.name?.toLowerCase() || '';\r\n    for (const [classKey, die] of Object.entries(hitDiceMap)) {\r\n      if (primaryClass.includes(classKey)) {\r\n        return die;\r\n      }\r\n    }\r\n  }\r\n\r\n  return 'd8'; // Default\r\n}\r\n\r\n/**\r\n * Parses API response into structured character data\r\n */\r\nexport function parseCharacterData(apiData, characterId) {\r\n  console.log('CarmaClouds: Parsing character data...');\r\n\r\n  if (!apiData.creatures || apiData.creatures.length === 0) {\r\n    console.error('CarmaClouds: No creatures found in API response');\r\n    throw new Error('No character data found in API response');\r\n  }\r\n\r\n  const creature = apiData.creatures[0];\r\n  const variables = (apiData.creatureVariables && apiData.creatureVariables[0]) || {};\r\n  const properties = apiData.creatureProperties || [];\r\n\r\n  console.log('CarmaClouds: Creature:', creature.name);\r\n  console.log('CarmaClouds: Variables count:', Object.keys(variables).length);\r\n  console.log('CarmaClouds: Properties count:', properties.length);\r\n\r\n  // Calculate AC from multiple sources\r\n  const calculateArmorClass = () => {\r\n    // Helper: try to coerce a variety of shapes into a numeric AC\r\n    const extractNumeric = (val) => {\r\n      if (val === null || val === undefined) return null;\r\n      if (typeof val === 'number' && !isNaN(val)) return val;\r\n      if (typeof val === 'string') {\r\n        const parsed = parseFloat(val);\r\n        return isNaN(parsed) ? null : parsed;\r\n      }\r\n      if (typeof val === 'object') {\r\n        if (val.total !== undefined && typeof val.total === 'number') return val.total;\r\n        if (val.value !== undefined && typeof val.value === 'number') return val.value;\r\n        if (val.calculation && typeof val.calculation === 'string') {\r\n          const bm = val.calculation.match(/^(\\d+)/);\r\n          if (bm) return parseInt(bm[1]);\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n\r\n    // Check if Dicecloud provided a calculated AC (most reliable)\r\n    if (variables.armorClass && (variables.armorClass.total || variables.armorClass.value)) {\r\n      const variableAC = variables.armorClass.total || variables.armorClass.value;\r\n      console.log(`CarmaClouds: Using Dicecloud's calculated AC: ${variableAC}`);\r\n      return variableAC;\r\n    }\r\n\r\n    // Try denormalizedStats\r\n    if (creature && creature.denormalizedStats) {\r\n      const tryKeys = ['armorClass', 'ac', 'armor'];\r\n      for (const k of tryKeys) {\r\n        if (creature.denormalizedStats.hasOwnProperty(k)) {\r\n          const num = extractNumeric(creature.denormalizedStats[k]);\r\n          if (num !== null) {\r\n            console.log(`CarmaClouds: Using denormalizedStats.${k}:`, num);\r\n            return num;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check variables for AC\r\n    const varNamesToCheck = ['armor', 'armorClass', 'armor_class', 'ac', 'acTotal'];\r\n    for (const vn of varNamesToCheck) {\r\n      if (variables.hasOwnProperty(vn)) {\r\n        const v = variables[vn];\r\n        const candidate = extractNumeric(v && (v.total ?? v.value ?? v));\r\n        if (candidate !== null) {\r\n          console.log(`CarmaClouds: Using variable ${vn}:`, candidate);\r\n          return candidate;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Calculate from properties (base + armor + bonuses)\r\n    let baseAC = 10;\r\n    let armorAC = null;\r\n    const acBonuses = [];\r\n\r\n    properties.forEach(prop => {\r\n      if (prop.inactive || prop.disabled) return;\r\n\r\n      const hasArmorStat = prop.stat === 'armor' ||\r\n                          (Array.isArray(prop.stats) && prop.stats.includes('armor'));\r\n\r\n      if (hasArmorStat) {\r\n        let amount = null;\r\n        if (typeof prop.amount === 'number') {\r\n          amount = prop.amount;\r\n        } else if (typeof prop.amount === 'string') {\r\n          amount = parseFloat(prop.amount);\r\n        }\r\n\r\n        if (amount !== null && !isNaN(amount)) {\r\n          const operation = prop.operation || '';\r\n\r\n          if (operation === 'base' || operation === 'Base value') {\r\n            if (armorAC === null || amount > armorAC) {\r\n              armorAC = amount;\r\n            }\r\n          } else if (operation === 'add' || operation === 'Add') {\r\n            acBonuses.push({ name: prop.name, amount });\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    let finalAC = armorAC !== null ? armorAC : baseAC;\r\n    acBonuses.forEach(bonus => {\r\n      finalAC += bonus.amount;\r\n    });\r\n\r\n    console.log('CarmaClouds: Calculated AC:', finalAC);\r\n    return finalAC;\r\n  };\r\n\r\n  // Extract race, class, and level from properties\r\n  let characterRace = 'Unknown';\r\n  let characterClass = '';\r\n  let characterLevel = 0;\r\n  const uniqueClasses = new Set();\r\n\r\n  console.log('CarmaClouds: Extracting race, class, level from properties...');\r\n  for (const prop of properties) {\r\n    if (!prop) continue;\r\n\r\n    // Extract race\r\n    if (prop.type === 'race' || prop.type === 'species' || prop.type === 'characterRace') {\r\n      if (prop.name) {\r\n        characterRace = prop.name;\r\n        console.log('CarmaClouds: Found race:', characterRace);\r\n      }\r\n    }\r\n\r\n    // Extract class\r\n    if (prop.type === 'class' && prop.name && !prop.inactive && !prop.disabled) {\r\n      const cleanName = prop.name.replace(/\\s*\\[Multiclass\\]/i, '').trim();\r\n      const normalizedClassName = cleanName.toLowerCase().trim();\r\n      if (!uniqueClasses.has(normalizedClassName)) {\r\n        uniqueClasses.add(normalizedClassName);\r\n        if (characterClass) {\r\n          characterClass += ` / ${cleanName}`;\r\n        } else {\r\n          characterClass = cleanName;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Extract level\r\n    if (prop.type === 'classLevel' && !prop.inactive && !prop.disabled) {\r\n      characterLevel += 1;\r\n      if (prop.name) {\r\n        const cleanName = prop.name.replace(/\\s*\\[Multiclass\\]/i, '').trim();\r\n        const normalizedClassName = cleanName.toLowerCase().trim();\r\n        if (!uniqueClasses.has(normalizedClassName)) {\r\n          uniqueClasses.add(normalizedClassName);\r\n          if (characterClass) {\r\n            characterClass += ` / ${cleanName}`;\r\n          } else {\r\n            characterClass = cleanName;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  console.log('CarmaClouds: Extracted race:', characterRace, 'class:', characterClass || 'Unknown', 'level:', characterLevel);\r\n\r\n  const characterData = {\r\n    id: creature._id || characterId,\r\n    name: creature.name || '',\r\n    race: characterRace,\r\n    class: characterClass || 'Unknown',\r\n    level: characterLevel,\r\n    background: '',\r\n    alignment: creature.alignment || '',\r\n    attributes: {},\r\n    attributeMods: {},\r\n    saves: {},\r\n    skills: {},\r\n    hitPoints: {\r\n      current: (variables.hitPoints && (variables.hitPoints.currentValue ?? variables.hitPoints.value)) || 0,\r\n      max: (variables.hitPoints && (variables.hitPoints.total ?? variables.hitPoints.max)) || 0\r\n    },\r\n    temporaryHP: (variables.temporaryHitPoints && (variables.temporaryHitPoints.value ?? variables.temporaryHitPoints.currentValue)) || 0,\r\n    armorClass: calculateArmorClass(),\r\n    speed: (variables.speed && (variables.speed.total || variables.speed.value)) || 30,\r\n    initiative: (variables.initiative && (variables.initiative.total || variables.initiative.value)) || 0,\r\n    proficiencyBonus: (variables.proficiencyBonus && (variables.proficiencyBonus.total || variables.proficiencyBonus.value)) || 0,\r\n    url: window.location.href,\r\n    timestamp: new Date().toISOString(),\r\n    source: 'dicecloud',\r\n    rawDiceCloudData: {\r\n      creature: creature,\r\n      variables: variables,\r\n      properties: properties\r\n    }\r\n  };\r\n\r\n  // Extract ability scores\r\n  STANDARD_VARS.abilities.forEach(ability => {\r\n    if (variables[ability]) {\r\n      characterData.attributes[ability] = variables[ability].total || variables[ability].value || 10;\r\n    } else {\r\n      characterData.attributes[ability] = 10; // Default\r\n    }\r\n  });\r\n\r\n  // Calculate modifiers\r\n  Object.keys(characterData.attributes).forEach(attr => {\r\n    const score = characterData.attributes[attr] || 10;\r\n    characterData.attributeMods[attr] = Math.floor((score - 10) / 2);\r\n  });\r\n\r\n  // Extract saves\r\n  STANDARD_VARS.saves.forEach(save => {\r\n    if (variables[save]) {\r\n      const abilityName = save.replace('Save', '');\r\n      characterData.saves[abilityName] = variables[save].total || variables[save].value || 0;\r\n    }\r\n  });\r\n\r\n  // Extract skills\r\n  STANDARD_VARS.skills.forEach(skill => {\r\n    if (variables[skill]) {\r\n      characterData.skills[skill] = variables[skill].total || variables[skill].value || 0;\r\n    }\r\n  });\r\n\r\n  console.log('CarmaClouds: Successfully parsed character data:', characterData.name);\r\n  return characterData;\r\n}\r\n", "/**\r\n * DiceCloud Content Script\r\n * Adds sync button to DiceCloud website and captures character data\r\n */\r\n\r\nimport { parseCharacterData } from './dicecloud-extraction.js';\r\n\r\nconsole.log('CarmaClouds: DiceCloud content script loaded');\r\n\r\n// Wait for page to load\r\nfunction waitForPageLoad() {\r\n  if (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', initializeDiceCloudSync);\r\n  } else {\r\n    initializeDiceCloudSync();\r\n  }\r\n}\r\n\r\n// Initialize the DiceCloud sync functionality\r\nfunction initializeDiceCloudSync() {\r\n  console.log('CarmaClouds: Initializing DiceCloud sync...');\r\n  \r\n  // Wait a bit for any dynamic content to load\r\n  setTimeout(() => {\r\n    console.log('CarmaClouds: Attempting to add sync button...');\r\n    addSyncButtonToDiceCloud();\r\n  }, 1000); // Reduced from 2000ms to 1000ms for faster appearance\r\n}\r\n\r\n// Add sync button to DiceCloud interface\r\nfunction addSyncButtonToDiceCloud() {\r\n  console.log('CarmaClouds: addSyncButtonToDiceCloud called');\r\n  \r\n  // Check if button already exists\r\n  if (document.querySelector('#carmaclouds-sync-btn')) {\r\n    console.log('CarmaClouds: Sync button already exists');\r\n    return;\r\n  }\r\n\r\n  console.log('CarmaClouds: Creating sync button container...');\r\n\r\n  // Create sync button container\r\n  const buttonContainer = document.createElement('div');\r\n  buttonContainer.id = 'carmaclouds-sync-container';\r\n  buttonContainer.style.cssText = `\r\n    position: fixed;\r\n    top: 80px;\r\n    right: 20px;\r\n    z-index: 10000;\r\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\r\n  `;\r\n\r\n  // Create draggable handle\r\n  const dragHandle = document.createElement('div');\r\n  dragHandle.innerHTML = '\u22EE\u22EE';\r\n  dragHandle.style.cssText = `\r\n    background: rgba(0, 0, 0, 0.8);\r\n    color: #fff;\r\n    padding: 4px 8px;\r\n    border-radius: 4px 4px 0 0;\r\n    cursor: move;\r\n    font-size: 12px;\r\n    text-align: center;\r\n    user-select: none;\r\n    border: 1px solid #333;\r\n    border-bottom: none;\r\n  `;\r\n\r\n  // Create sync button\r\n  const syncButton = document.createElement('button');\r\n  syncButton.id = 'carmaclouds-sync-btn';\r\n  syncButton.innerHTML = `\r\n    <div style=\"display: flex; align-items: center; gap: 8px;\">\r\n      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n        <path d=\"M23 4v6h-6M1 20v-6h6\"/>\r\n        <path d=\"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15\"/>\r\n      </svg>\r\n      <span>Sync to CarmaClouds</span>\r\n    </div>\r\n  `;\r\n  \r\n  // Style the button to match DiceCloud's design\r\n  syncButton.style.cssText = `\r\n    background: linear-gradient(135deg, #16a75a 0%, #0d8045 100%);\r\n    color: #000000;\r\n    border: none;\r\n    padding: 8px 16px;\r\n    border-radius: 0 0 6px 6px;\r\n    font-weight: 600;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    transition: all 0.2s ease;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n    border: 1px solid #333;\r\n    border-top: none;\r\n  `;\r\n\r\n  syncButton.addEventListener('mouseenter', () => {\r\n    syncButton.style.background = 'linear-gradient(135deg, #1bc76b 0%, #0f9055 100%)';\r\n    syncButton.style.transform = 'translateY(-1px)';\r\n    syncButton.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';\r\n  });\r\n\r\n  syncButton.addEventListener('mouseleave', () => {\r\n    syncButton.style.background = 'linear-gradient(135deg, #16a75a 0%, #0d8045 100%)';\r\n    syncButton.style.transform = 'translateY(0)';\r\n    syncButton.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';\r\n  });\r\n\r\n  // Add click handler\r\n  syncButton.addEventListener('click', handleSyncToCarmaClouds);\r\n\r\n  // Add drag functionality\r\n  let isDragging = false;\r\n  let currentX;\r\n  let currentY;\r\n  let initialX;\r\n  let initialY;\r\n  let xOffset = 0;\r\n  let yOffset = 0;\r\n\r\n  // Restore saved position with bounds checking\r\n  const savedPosition = localStorage.getItem('carmaclouds_button_position');\r\n  if (savedPosition) {\r\n    try {\r\n      const pos = JSON.parse(savedPosition);\r\n      // Keep button on screen by clamping offsets\r\n      const maxRight = window.innerWidth - 200; // Button width ~200px\r\n      const maxBottom = window.innerHeight - 100; // Button height ~100px\r\n      xOffset = Math.max(-window.innerWidth + 200, Math.min(maxRight, pos.x || 0));\r\n      yOffset = Math.max(-100, Math.min(maxBottom, pos.y || 0));\r\n      buttonContainer.style.transform = `translate(${xOffset}px, ${yOffset}px)`;\r\n    } catch (e) {\r\n      console.warn('CarmaClouds: Could not restore button position');\r\n    }\r\n  }\r\n\r\n  dragHandle.addEventListener('mousedown', dragStart);\r\n  document.addEventListener('mousemove', drag);\r\n  document.addEventListener('mouseup', dragEnd);\r\n\r\n  function dragStart(e) {\r\n    initialX = e.clientX - xOffset;\r\n    initialY = e.clientY - yOffset;\r\n\r\n    if (e.target === dragHandle) {\r\n      isDragging = true;\r\n      dragHandle.style.background = 'rgba(0, 0, 0, 0.9)';\r\n    }\r\n  }\r\n\r\n  function drag(e) {\r\n    if (isDragging) {\r\n      e.preventDefault();\r\n      currentX = e.clientX - initialX;\r\n      currentY = e.clientY - initialY;\r\n\r\n      // Keep button on screen while dragging\r\n      const maxRight = window.innerWidth - 200;\r\n      const maxBottom = window.innerHeight - 100;\r\n      currentX = Math.max(-window.innerWidth + 200, Math.min(maxRight, currentX));\r\n      currentY = Math.max(-100, Math.min(maxBottom, currentY));\r\n\r\n      xOffset = currentX;\r\n      yOffset = currentY;\r\n\r\n      buttonContainer.style.transform = `translate(${currentX}px, ${currentY}px)`;\r\n    }\r\n  }\r\n\r\n  function dragEnd(e) {\r\n    if (isDragging) {\r\n      initialX = currentX;\r\n      initialY = currentY;\r\n      isDragging = false;\r\n      dragHandle.style.background = 'rgba(0, 0, 0, 0.8)';\r\n      \r\n      // Save position to localStorage\r\n      localStorage.setItem('carmaclouds_button_position', JSON.stringify({\r\n        x: xOffset,\r\n        y: yOffset\r\n      }));\r\n    }\r\n  }\r\n\r\n  // Assemble the container\r\n  buttonContainer.appendChild(dragHandle);\r\n  buttonContainer.appendChild(syncButton);\r\n\r\n  // Add to page (fixed position, not in any container)\r\n  console.log('CarmaClouds: Adding button to document.body...');\r\n  document.body.appendChild(buttonContainer);\r\n  \r\n  // Verify the button was added\r\n  const addedButton = document.querySelector('#carmaclouds-sync-btn');\r\n  console.log('CarmaClouds: Button verification:', addedButton ? 'SUCCESS' : 'FAILED');\r\n  console.log('CarmaClouds: Sync button added to DiceCloud');\r\n}\r\n\r\n// Handle sync to CarmaClouds\r\nasync function handleSyncToCarmaClouds() {\r\n  const button = document.querySelector('#carmaclouds-sync-btn');\r\n  const originalContent = button.innerHTML;\r\n  \r\n  try {\r\n    // Show loading state\r\n    button.innerHTML = `\r\n      <div style=\"display: flex; align-items: center; gap: 8px;\">\r\n        <div style=\"width: 16px; height: 16px; border: 2px solid #000; border-top: 2px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;\"></div>\r\n        <span>Syncing...</span>\r\n      </div>\r\n    `;\r\n    button.disabled = true;\r\n\r\n    // Get character data from DiceCloud page\r\n    const characterData = await extractCharacterData();\r\n    \r\n    if (!characterData) {\r\n      throw new Error('Could not extract character data from DiceCloud');\r\n    }\r\n\r\n    console.log('CarmaClouds: Extracted character data:', characterData);\r\n\r\n    // Send data to extension background script\r\n    const response = await chrome.runtime.sendMessage({\r\n      type: 'SYNC_CHARACTER_TO_CARMACLOUDS',\r\n      data: characterData\r\n    });\r\n\r\n    if (response && response.success) {\r\n      // Show success state\r\n      button.innerHTML = `\r\n        <div style=\"display: flex; align-items: center; gap: 8px;\">\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"></path>\r\n            <polyline points=\"22 4 12 14.01 9 11.01\"></polyline>\r\n          </svg>\r\n          <span>Synced!</span>\r\n        </div>\r\n      `;\r\n      button.style.background = 'linear-gradient(135deg, #28a745 0%, #1e7e34 100%)';\r\n      \r\n      // Reset after 3 seconds\r\n      setTimeout(() => {\r\n        button.innerHTML = originalContent;\r\n        button.style.background = 'linear-gradient(135deg, #16a75a 0%, #0d8045 100%)';\r\n        button.disabled = false;\r\n      }, 3000);\r\n    } else {\r\n      throw new Error(response?.error || 'Failed to sync character data');\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('CarmaClouds: Sync error:', error);\r\n    \r\n    // Show error state\r\n    button.innerHTML = `\r\n      <div style=\"display: flex; align-items: center; gap: 8px;\">\r\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n          <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\r\n          <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"></line>\r\n          <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"></line>\r\n        </svg>\r\n        <span>Sync Failed</span>\r\n      </div>\r\n    `;\r\n    button.style.background = 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)';\r\n    \r\n    // Reset after 3 seconds\r\n    setTimeout(() => {\r\n      button.innerHTML = originalContent;\r\n      button.style.background = 'linear-gradient(135deg, #16a75a 0%, #0d8045 100%)';\r\n      button.disabled = false;\r\n    }, 3000);\r\n  }\r\n}\r\n\r\n// Extract character data from DiceCloud page\r\nasync function extractCharacterData() {\r\n  try {\r\n    console.log('CarmaClouds: Extracting character data using DiceCloud API...');\r\n    \r\n    // Extract character ID from URL\r\n    function getCharacterIdFromUrl() {\r\n      const url = window.location.pathname;\r\n      console.log('CarmaClouds: Parsing URL:', url);\r\n\r\n      const patterns = [\r\n        /\\/character\\/([^/]+)/,           // /character/ABC123\r\n        /\\/character\\/([^/]+)\\/[^/]+/,    // /character/ABC123/CharName\r\n        /character=([^&]+)/,              // ?character=ABC123\r\n      ];\r\n\r\n      for (const pattern of patterns) {\r\n        const match = url.match(pattern);\r\n        if (match) {\r\n          console.log('CarmaClouds: Found character ID:', match[1]);\r\n          return match[1];\r\n        }\r\n      }\r\n\r\n      console.error('CarmaClouds: Could not extract character ID from URL');\r\n      return null;\r\n    }\r\n    \r\n    const characterId = getCharacterIdFromUrl();\r\n    if (!characterId) {\r\n      throw new Error('Not on a character page. Navigate to a character sheet first.');\r\n    }\r\n\r\n    // Get API token from extension storage\r\n    const tokenResult = await chrome.storage.local.get(['dicecloud_auth_token']);\r\n    const token = tokenResult.dicecloud_auth_token;\r\n    \r\n    if (!token) {\r\n      throw new Error('Not logged in to DiceCloud. Please login via the extension popup.');\r\n    }\r\n\r\n    console.log('CarmaClouds: Fetching character data from API...');\r\n    \r\n    // Fetch character data from DiceCloud API\r\n    const API_BASE = 'https://dicecloud.com/api';\r\n    const timestamp = Date.now();\r\n    const apiUrl = `${API_BASE}/creature/${characterId}?_t=${timestamp}`;\r\n    \r\n    const response = await fetch(apiUrl, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`,\r\n        'Content-Type': 'application/json',\r\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n        'Pragma': 'no-cache',\r\n        'Expires': '0'\r\n      },\r\n      cache: 'no-store'\r\n    });\r\n\r\n    console.log('CarmaClouds: API Response status:', response.status);\r\n\r\n    if (!response.ok) {\r\n      if (response.status === 401) {\r\n        throw new Error('API token expired. Please login again via the extension popup.');\r\n      }\r\n      const errorText = await response.text();\r\n      console.error('CarmaClouds: API Error Response:', errorText);\r\n      throw new Error(`API request failed: ${response.status} ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    console.log('CarmaClouds: Received API data');\r\n\r\n    // Parse the character data using comprehensive extraction\r\n    const characterData = parseCharacterData(data, characterId);\r\n    console.log('CarmaClouds: Successfully extracted character data:', characterData);\r\n    return characterData;\r\n    \r\n  } catch (error) {\r\n    console.error('CarmaClouds: Error extracting character data:', error);\r\n    \r\n    // Fallback to basic page extraction if API fails\r\n    console.log('CarmaClouds: Trying fallback page extraction...');\r\n    \r\n    const characterName = document.querySelector('h1, .character-name, [data-testid=\"character-name\"]')?.textContent?.trim();\r\n    if (characterName) {\r\n      return {\r\n        name: characterName,\r\n        level: 'Unknown',\r\n        class: 'Unknown', \r\n        race: 'Unknown',\r\n        url: window.location.href,\r\n        timestamp: new Date().toISOString(),\r\n        source: 'dicecloud',\r\n        extractionError: error.message\r\n      };\r\n    }\r\n    \r\n    throw error;\r\n  }\r\n}\r\n\r\n// Add CSS animation for loading spinner\r\nconst style = document.createElement('style');\r\nstyle.textContent = `\r\n  @keyframes spin {\r\n    0% { transform: rotate(0deg); }\r\n    100% { transform: rotate(360deg); }\r\n  }\r\n`;\r\ndocument.head.appendChild(style);\r\n\r\n// Watch for URL changes (for client-side routing)\r\nlet lastUrl = location.href;\r\nnew MutationObserver(() => {\r\n  const url = location.href;\r\n  if (url !== lastUrl) {\r\n    lastUrl = url;\r\n    console.log('CarmaClouds: URL changed to:', url);\r\n    // Re-check if we should add the button\r\n    setTimeout(() => {\r\n      if (!document.querySelector('#carmaclouds-sync-btn')) {\r\n        console.log('CarmaClouds: Button not found after navigation, re-adding...');\r\n        addSyncButtonToDiceCloud();\r\n      }\r\n    }, 1500);\r\n  }\r\n}).observe(document, { subtree: true, childList: true });\r\n\r\n// Initialize when page loads\r\nwaitForPageLoad();\r\n"],
  "mappings": "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",
  "names": []
}
